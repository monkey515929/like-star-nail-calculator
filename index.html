<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Like STar Nail</title>
<style>
body{
  font-family:-apple-system,BlinkMacSystemFont;
  background:#f4f4f4;
  margin:0;padding:16px;
}
h1,h2{margin:12px 0;}
.section{
  background:#fff;
  border-radius:14px;
  padding:14px;
  margin-bottom:18px;
}
.item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:6px 0;
}
.ctrl{
  display:flex;
  align-items:center;
  gap:10px;
}
.ctrl button{
  width:30px;height:30px;
  border:none;border-radius:50%;
  background:#111;color:#fff;
  font-size:18px;
}
textarea{
  width:100%;
  min-height:220px;
  font-size:14px;
}
.admin-item{
  display:flex;
  gap:6px;
  margin:6px 0;
}
.admin-item input{
  flex:1;
}
.drag{
  cursor:grab;
  user-select:none;
}
.hidden{display:none;}
.copy-btn{
  width:100%;
  padding:10px;
  border:none;
  border-radius:10px;
  background:#000;
  color:#fff;
  font-size:16px;
  margin-bottom:10px;
}
</style>
</head>
<body>

<h1>Like STar Nail</h1>

<button onclick="toggleAdmin()">åˆ‡æ› å‰å° / å¾Œå°</button>

<!-- å‰å° -->
<div id="front"></div>

<h2>âœ¨ çµ¦å®¢äººçš„æ˜ç´°</h2>
<button class="copy-btn" onclick="copyReceipt()">ğŸ“‹ ä¸€éµè¤‡è£½æ˜ç´°</button>
<textarea id="receipt" readonly></textarea>

<!-- å¾Œå° -->
<div id="admin" class="hidden">
  <h2>ğŸ”’ å¾Œå°è¨­å®š</h2>
  <div id="adminList"></div>
  <button onclick="addItem()">ï¼‹ æ–°å¢é …ç›®</button>
</div>

<script>
const STORAGE_KEY='like_star_nail_v3';

let items=JSON.parse(localStorage.getItem(STORAGE_KEY))||[
 {cat:'åŸºæœ¬å–®è‰²',name:'å–®è‰²å‡è† ',price:800,qty:0},
 {cat:'åŠ åƒ¹å–®æŒ‡',name:'é¡é¢(å–®æŒ‡)',price:120,qty:0},
 {cat:'åŠ åƒ¹å–®æŒ‡',name:'ç«‹é«”é€ å‹/ç•°æè³ª(å–®æŒ‡)',price:100,qty:0},
 {cat:'å»¶ç”²',name:'å»¶ç”²(å–®æŒ‡)',price:100,qty:0},
 {cat:'å¸ç”²',name:'ä»–åº—å¸ç”²',price:500,qty:0},
 {cat:'æ‰£é™¤',name:'è¨‚é‡‘500',price:-500,qty:0},
 {cat:'æ‰£é™¤',name:'è¨‚é‡‘1000',price:-1000,qty:0}
];

function save(){
 localStorage.setItem(STORAGE_KEY,JSON.stringify(items));
}

function renderFront(){
 const front=document.getElementById('front');
 front.innerHTML='';
 [...new Set(items.map(i=>i.cat))].forEach(cat=>{
  const sec=document.createElement('div');
  sec.className='section';
  sec.innerHTML=`<h2>${cat}</h2>`;
  items.filter(i=>i.cat===cat).forEach(i=>{
   const row=document.createElement('div');
   row.className='item';
   row.innerHTML=`
    <div>${i.name} $${i.price}</div>
    <div class="ctrl">
      <button onclick="qty('${i.name}',-1)">âˆ’</button>
      <div>${i.qty}</div>
      <button onclick="qty('${i.name}',1)">ï¼‹</button>
    </div>`;
   sec.appendChild(row);
  });
  front.appendChild(sec);
 });
}

function qty(name,d){
 const it=items.find(i=>i.name===name);
 it.qty=Math.max(0,it.qty+d);
 save(); render();
}

function renderReceipt(){
 let lines=[],total=0,deposit=0;
 items.forEach(i=>{
  if(i.qty>0){
   const sum=i.price*i.qty;
   if(i.price<0) deposit+=sum;
   else total+=sum;
   lines.push(`${i.name} x${i.qty} : $${sum}`);
  }
 });
 document.getElementById('receipt').value=
`âœ¨ Like STar Nail çµå¸³æ˜ç´° âœ¨
--------------------------
${lines.join('\n')}
--------------------------
ç¸½è¨ˆé‡‘é¡: $${total}
å·²ä»˜å®šé‡‘: ${deposit}
ç¾å ´æ‡‰ä»˜: $${total+deposit}
--------------------------
æœŸå¾…ä¸‹æ¬¡ç‚ºæ‚¨æœå‹™ï¼`;
}

function copyReceipt(){
 const text=document.getElementById('receipt').value;
 navigator.clipboard.writeText(text).then(()=>{
  alert('æ˜ç´°å·²è¤‡è£½ï¼Œå¯ç›´æ¥è²¼çµ¦å®¢äºº');
 });
}

function renderAdmin(){
 const list=document.getElementById('adminList');
 list.innerHTML='';
 items.forEach((i,idx)=>{
  const row=document.createElement('div');
  row.className='admin-item';
  row.innerHTML=`
   <span class="drag">â˜°</span>
   <input value="${i.name}" onchange="items[${idx}].name=this.value;save();render()">
   <input type="number" value="${i.price}" onchange="items[${idx}].price=+this.value;save();render()">
   <input value="${i.cat}" onchange="items[${idx}].cat=this.value;save();render()">`;
  list.appendChild(row);
 });
}

function addItem(){
 items.push({cat:'è‡ªè¨‚',name:'æ–°é …ç›®',price:0,qty:0});
 save(); render();
}

function toggleAdmin(){
 document.getElementById('admin').classList.toggle('hidden');
}

function render(){
 renderFront();
 renderAdmin();
 renderReceipt();
}

render();
</script>
</body>
</html>