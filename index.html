<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>Like STar nail｜美甲計算機</title>

<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont;
  background:#f6f4f2;
  padding:20px;
  color:#333;
}
h1 {
  text-align:center;
  font-weight:600;
}
.section {
  background:#fff;
  border-radius:14px;
  padding:15px;
  margin-bottom:20px;
}
.section h2 {
  font-size:16px;
  margin-bottom:10px;
}
.item {
  display:flex;
  gap:6px;
  margin-bottom:6px;
}
.item input {
  flex:1;
  padding:6px;
}
.item button {
  background:#ddd;
  border:none;
  border-radius:6px;
}
.total {
  font-size:18px;
  text-align:right;
}
textarea {
  width:100%;
  height:80px;
}
</style>
</head>

<body>

<h1>Like STar nail</h1>

<div class="section">
<h2>基本款 / 單色</h2>
<div id="basic"></div>
<button onclick="addItem('basic')">＋新增項目</button>
</div>

<div class="section">
<h2>加價單指 / 設計</h2>
<div id="design"></div>
<button onclick="addItem('design')">＋新增項目</button>
</div>

<div class="section">
<h2>卸甲</h2>
<div id="remove"></div>
<button onclick="addItem('remove')">＋新增項目</button>
</div>

<div class="section">
<h2>調整</h2>
<button onclick="applyDeposit(500)">扣訂金 500</button>
<button onclick="applyDeposit(1000)">扣訂金 1000</button>
<button onclick="applyDiscount()">扣除基本單色</button>
</div>

<div class="section">
<h2>備註 / 傳 LINE 給客人</h2>
<textarea id="note"></textarea>
<button onclick="copyLine()">複製明細</button>
</div>

<div class="section total">
總金額：$<span id="total">0</span>
</div>

<script>
const sections = ['basic','design','remove'];
let discount = 0;
let deposit = 0;

sections.forEach(id=>{
  new Sortable(document.getElementById(id), {
    animation:150
  });
});

function addItem(section){
  const div = document.createElement('div');
  div.className='item';
  div.innerHTML = `
    <input placeholder="項目名稱">
    <input type="number" placeholder="價格" oninput="calc()">
    <input type="number" value="1" min="1" oninput="calc()">
    <button onclick="this.parentNode.remove();calc()">✕</button>
  `;
  document.getElementById(section).appendChild(div);
}

function calc(){
  let sum = 0;
  document.querySelectorAll('.item').forEach(i=>{
    const price = i.children[1].value || 0;
    const qty = i.children[2].value || 1;
    sum += price * qty;
  });
  document.getElementById('total').innerText = sum - discount - deposit;
}

function applyDeposit(val){
  deposit = val;
  calc();
}

function applyDiscount(){
  const first = document.querySelector('#basic .item input[type=number]');
  discount = first ? first.value : 0;
  calc();
}

function copyLine(){
  let text = 'Like STar nail 美甲明細\n';
  document.querySelectorAll('.item').forEach(i=>{
    const name=i.children[0].value;
    const price=i.children[1].value;
    const qty=i.children[2].value;
    if(name) text+=`${name} x${qty} $${price*qty}\n`;
  });
  text+=`訂金扣除：$${deposit}\n`;
  text+=`折扣：$${discount}\n`;
  text+=`總金額：$${document.getElementById('total').innerText}\n`;
  text+=`備註：${document.getElementById('note').value}`;
  navigator.clipboard.writeText(text);
  alert('已複製，可直接貼 LINE');
}
</script>

</body>
</html>